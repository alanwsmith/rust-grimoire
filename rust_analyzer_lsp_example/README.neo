-- title

Rust LSP Server Completion Example

A basic LSP server built powered by the code
from rust_analyzer. It has two baisc examples:

-- olist

1. Code Completion

2. Document formatting


-- notes/

- This project is based off [[this example|
https://github.com/rust-lang/rust-analyzer/blob/master/lib/lsp-server/examples/goto_def.rs]].

That one only does "GotoDefinition". This one provides
Completion and Formatting instead. 

- The original code uses Vfs for a virtual file system. 
That caused me issues. I went to a basic hashmap to
hold the content for the documents. 

- This is set up to send the full contents of the file
to the LSP server on every chanage. Setting up to 
send only file changes is out of scope for this example. 

- This example doesn't make use of any of the work in progress
tokens. They are out of scope for this example. 

- There's ton stuff that's avaialbe with LSPs. For 
examples, check out:

[[The Language Server Protocol home page|
https://microsoft.github.io/language-server-protocol/]]

and

[[The Rust lsp_types crate|
https://docs.rs/lsp-types/latest/lsp_types/index.html]]

- The example sets up to trigger complections that
start with "-". The example shows "-- test" which will
completed from the dahses. It drops the complection
at the space between "--" and "test". Dealing
with that is outside the scope of this example.

- This isn't set up for unsaved files. It expects everything
to have a URI. 



-- /notes



-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/enum.Message.html


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/enum.Message.html#variant.Notification


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/enum.Message.html#variant.Request


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/enum.Message.html#variant.Response


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Notification.html


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Notification.html#structfield.params


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Request.html


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Request.html#method.extract


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Request.html#structfield.method


-- ref
-- url: https://docs.rs/lsp-server/latest/lsp_server/struct.Response.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/all.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/enum.TextDocumentSyncCapability.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/enum.TypeDefinitionProviderCapability.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/notification/enum.DidChangeTextDocument.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/notification/index.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/request/enum.Completion.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/request/trait.Request.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/request/trait.Request.html#associatedconstant.METHOD


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionContext.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionItem.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionList.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionOptions.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionParams.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionParams.html#structfield.context


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.CompletionTriggerKind.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.DidChangeTextDocumentParams.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.InitializeParams.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.PartialResultParams.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.Position.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.Range.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.ServerCapabilities.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.ServerCapabilities.html#structfield.document_formatting_provider


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.ServerCapabilities.html#structfield.text_document_sync


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.ServerCapabilities.html#structfield.type_definition_provider


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.TextDocumentContentChangeEvent.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.TextDocumentPositionParams.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.TextDocumentSyncOptions.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.TextEdit.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.VersionedTextDocumentIdentifier.html


-- ref
-- url: https://docs.rs/lsp-types/latest/lsp_types/struct.WorkDoneProgressParams.html


-- ref
-- url: https://docs.rs/tracing/latest/tracing/


-- ref
-- url: https://docs.rs/unicode-segmentation/latest/unicode_segmentation/trait.UnicodeSegmentation.html#tymethod.graphemes


-- ref
-- url: https://github.com/rust-lang/rust-analyzer/tree/master/lib/lsp-server/examples


-- ref
-- url: https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/




-- page
-- created: 2025-06-14T12:10:55-04:00
-- updated: 2025-06-14T12:10:55-04:00
-- id: 2y/vq/r2/6g
-- template: post
-- status: draft


